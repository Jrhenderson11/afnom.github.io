<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Barmixing-Bot</title>
  <meta name="description" content="Description">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/bootstrap.css">
  <script src="/js/jquery-1.10.2.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <link rel="canonical" href="http://afnom.net/2014/10/24/19-barmixing-bot.html">
  <link rel="alternate" type="application/rss+xml" title="AFiniteNumberOfMonkeys" href="http://afnom.net/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="http://afnom.net/" class="navbar-brand">AFiniteNumberOfMonkeys</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav navbar-right">
			<li class="dropdown">
			   <a class="dropdown-toggle" data-toggle="dropdown" href="http://afnom.net" id="home">Home <span class="caret"></span></a>
			   <ul class="dropdown-menu" aria-labelledby="home">
			     <li><a href="http://afnom.net/#who">Who we are</a></li>
			     <li><a href="http://afnom.net/#meetings">Meetings</a></li>
			     <li><a href="http://afnom.net/#tools">Tools</a></li>
			     <li><a href="http://afnom.net/#materials">Learning material</a></li>
			     <li><a href="http://afnom.net/#contact">Contact</a></li>
			   </ul>
			 </li>
            <li><a href="http://afnom.net/writeups.html">Write-ups</a></li>
          </ul>

        </div>
      </div>
    </div>
</div>

        
          
        
          
        
          
        
          
        
          
        


</header>


    <div class="page-content">
      <div class="container">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Barmixing-Bot</h1>
    <p class="post-meta">Oct 24, 2014 • xorpse</p>
  </header>

  <article class="post-content">
    <h2 id="description">Description</h2>

<p>Author: freddy</p>

<p>Category: Misc</p>

<p>There’s a fun and quirky IRC bot to play with. It responds to commands in
private chat but also in #hacklu-saloon on freenode. We think it’s involved in
a devious scheme that distracts people to get their money pickpocketed. So be
careful!</p>

<h2 id="solution">Solution</h2>

<p>Author: Sam Thomas / xorpse</p>

<p>By starting a query with the bot and issuing a <code>!help</code> command, we get some
information on how the bot functions:</p>

<pre><code>-!- Irssi: Starting query in FreeNode with barmixing-bot
&lt;xorpse&gt; !help
&lt;barmixing-bot&gt; Send messages to the bot or the channel starting with an
exclamation mark. Known commands are list, status, karma, math, base64,
base64d, rot13, ping, hack, request, list
</code></pre>

<p>Sending <code>!status</code> gives us a list of channels in which the bot resides; this
includes a channel called <code>#hacklu-secret-channel</code>:</p>

<pre><code>My name is barmixing-bot, my uptime is 12 hours 35 minutes and 42 seconds. I
am on the following channels: #hacklu-saloon, #hacklu-secret-channel, ...
</code></pre>

<p>The intuition is that the flag might be accessible by joining
<code>#hacklu-secret-channel</code> (since it’s not possible to join it without an invite).</p>

<p>After testing some of the commands, we see that <code>!base64d</code> will cause the bot to
echo whatever it decodes verbatim. The IRC command for inviting someone to a
channel is:</p>

<pre><code>invite &lt;name&gt; &lt;channel&gt;
</code></pre>

<p>Using the bot we encode the command (note: this will be echoed as a PRIVMSG by
the bot rather than an INVITE command):</p>

<pre><code>&lt;xorpse&gt; !base64 invite xorpse #hacklu-secret-channel
&lt;barmixing-bot&gt; aW52aXRlIHhvcnBzZSAjaGFja2x1LXNlY3JldC1jaGFubmVs
</code></pre>

<p>And then have it decode the command:</p>

<pre><code>&lt;xorpse&gt; !base64d aW52aXRlIHhvcnBzZSAjaGFja2x1LXNlY3JldC1jaGFubmVs
-!- barmixing-bot invites you to #hacklu-secret-channel
&lt;barmixing-bot&gt; invite xorpse #hacklu-secret-channel
</code></pre>

<p>It seems the bot must scan what it decodes for an invite command and then act
accordingly.</p>

<p>The topic in <code>#hacklu-secret-channel</code> is the flag:</p>

<pre><code>FLAG: GfeBNmN5XjwDvQB64qoqaEEeYogk4rGH3ikZ0qtc3B3HKLDoAH
</code></pre>

  </article>

</div>

      </div>
    </div>

    <hr>
<footer class="site-footer">

  <div class="container">

    <div class="row">
      <div class="col-lg-12">

       
        <p><p>Copyright &copy; University of Birmingham 2014</p></p>

      </div>
    </div>

  </div>

</footer>


  </body>

</html>
