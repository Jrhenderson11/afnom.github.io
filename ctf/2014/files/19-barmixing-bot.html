<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Hack.lu CTF 2014: Barmixing-Bot</title>
<link rel="stylesheet" href="http://markable.in/site_media/static/bootstrap/css/bootstrap.min.css">
</script>
<style>
body {
	margin:2em 2em 2em 2em
}
</style>
</head>

<body>
<h1 id="challenge-19-barmixing-bot">Challenge #19: Barmixing-Bot</h1>
<h2 id="description">Description</h2>
<p>Author: freddy
Category: Misc</p>
<p>There's a fun and quirky IRC bot to play with. It responds to commands in
private chat but also in #hacklu-saloon on freenode. We think it's involved in
a devious scheme that distracts people to get their money pickpocketed. So be
careful!</p>
<h2 id="solution">Solution</h2>
<p>Author: Sam Thomas / xorpse</p>
<p>By starting a query with the bot and issuing a <code>!help</code> command, we get some
information on how the bot functions:</p>
<pre><code>-!- Irssi: Starting query in FreeNode with barmixing-bot
&lt;xorpse&gt; !help
&lt;barmixing-bot&gt; Send messages to the bot or the channel starting with an
exclamation mark. Known commands are list, status, karma, math, base64,
base64d, rot13, ping, hack, request, list
</code></pre>

<p>Sending <code>!status</code> gives us a list of channels in which the bot resides; this
includes a channel called <code>#hacklu-secret-channel</code>:</p>
<pre><code>My name is barmixing-bot, my uptime is 12 hours 35 minutes and 42 seconds. I
am on the following channels: #hacklu-saloon, #hacklu-secret-channel, ...
</code></pre>

<p>The intuition is that the flag might be accessible by joining
<code>#hacklu-secret-channel</code> (since it's not possible to join it without an invite).</p>
<p>After testing some of the commands, we see that <code>!base64d</code> will cause the bot to
echo whatever it decodes verbatim. The IRC command for inviting someone to a
channel is:</p>
<pre><code>invite &lt;name&gt; &lt;channel&gt;
</code></pre>

<p>Using the bot we encode the command (note: this will be echoed as a PRIVMSG by
the bot rather than an INVITE command):</p>
<pre><code>&lt;xorpse&gt; !base64 invite xorpse #hacklu-secret-channel
&lt;barmixing-bot&gt; aW52aXRlIHhvcnBzZSAjaGFja2x1LXNlY3JldC1jaGFubmVs
</code></pre>

<p>And then have it decode the command:</p>
<pre><code>&lt;xorpse&gt; !base64d aW52aXRlIHhvcnBzZSAjaGFja2x1LXNlY3JldC1jaGFubmVs
-!- barmixing-bot invites you to #hacklu-secret-channel
&lt;barmixing-bot&gt; invite xorpse #hacklu-secret-channel
</code></pre>

<p>It seems the bot must scan what it decodes for an invite command and then act
accordingly.</p>
<p>The topic in <code>#hacklu-secret-channel</code> is the flag:</p>
<pre><code>FLAG: GfeBNmN5XjwDvQB64qoqaEEeYogk4rGH3ikZ0qtc3B3HKLDoAH
</code></pre>
</body>